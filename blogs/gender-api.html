<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Using the Gender API | Bram ten Hove</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link href="/public/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/public/stylesheets/vendor/prism.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-26432716-1', 'bramtenhove.nl');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <div id="page">

      <header id="header" role="header">
        <div class="wrapper clearfix">
          <div id="logo">
            <a href="/"></a>
          </div>

          <div class="navigation">
            <nav id="main-menu" role="navigation">
              <div id="pull-menu"></div>
              <ul class="menu clearfix">
                <li><a href="/" class="active">Blog</a></li>
                <li><a href="/contact">Contact</a></li>
              </ul>
            </nav>
          </div>
        </div>
      </header>

      <div id="expose" role="banner">
        <div class="wrapper">
          <h3 class="expose-title">Gender API is a gem</h3>
          <h3 class="expose-subtitle">Making your life easier and that of your visitors</h3>
        </div>
      </div>

      <div id="main" class="column wrapper">

        <div id="main-content" role="main">
          <div class="container blog full-display">
            <h1 class="content-title"><a href="#">Using the Gender API</a></h1>
            <p>In the past months I searched the web for APIs to play with. I found quite a few that I wanted to try out. Some of them are actually useful, others not so much. In the coming weeks I will be showcasing interesting, useful or fun ones I found.</p>

            <p>Without further ado, I present you the <a href="https://gender-api.com" rel="nofollow">Gender API</a>. It's a neat little gem that can detect a gender by first name or even an e-mailaddress. There are several options which can increase the accuracy, like location or language. For example we could ask for the gender of someone named "<a href="https://gender-api.com/get?name=Bram" rel="nofollow">Bram</a>" and it will return "male".</p>

            <p>That's actually quite handy! You can use it for registration forms to fill the gender for the user, so he can proceed with more important steps. Or what about contact forms? You can be pretty sure you are talking to an actual sir or madam, instead of either one (Dear Sir or Madam). It's atleast a little bit more personal.</p>

            <p>Gender API delivers a straightforward API that is easy to implement and understand. And making things easier for you, I wrote a <a href="#all-the-code">tiny PHP wrapper</a>. It's usable, although there is room for improvement.</p>

            <p>Ofcourse there are more examples of APIs like this, for example we have <a href="http://genderize.io" rel="nofollow">Genderize.io</a> or <a href="http://www.i-gender.com/main/index.html" rel="nofollow">iGender</a>. But I prefer Gender API, mainly because they give the option to detect location by IP address. Supply them with an IP address and the accuracy is increased instantaneously. For example if we would search for "Andrea" in Germany the result will be "female", but search for it in Italy and you will get "male".</p>

            <p>Below you can find some examples of how to use this PHP wrapper. If you like this leave a message in my <a href="/contact">contact form</a>, since comments aren't available yet ;)</p>

            <h2><a name="the-code">The code</a></h2>
            <h3>Usage</h3>
            <p>You can easily use it like this:</p>
            <pre class="language-php"><code>// Instantiate new GenderGuess object.
$genderGuesser = new GenderGuess();

// Give me the gender.
try {
  $gender = $genderGuesser->guessGender('Bram ten Hove', $ipaddress);
} catch (Exception $e) {
  $gender = 'Error occured, no detection possible.';
}</code></pre>

            <h3>Some examples</h3>
            <pre class="language-php"><code>$genderGuesser = new GenderGuess();
$genderGuesser->guessGender('Bram ten Hove');</code></pre>
            <p>Returns "male".</p>
            <pre class="language-php"><code>$genderGuesser = new GenderGuess();
$genderGuesser->guessGender('Renee');</code></pre>
            <p>Returns "male".</p>
            <pre class="language-php"><code>$genderGuesser = new GenderGuess();
$genderGuesser->guessGender('Andrea', '2.119.255.255'); // Italy.</code></pre>
            <p>Returns "male".</p>
            <pre class="language-php"><code>$genderGuesser = new GenderGuess();
$genderGuesser->guessGender('saqwdas');</code></pre>
            <p>Returns "unknown".</p>
            <pre class="language-php"><code>$genderGuesser = new GenderGuess();
$genderGuesser->guessGender('A.');</code></pre>
            <p>Throws an exception because of an unusable first name.</p>

            <h3>The class with functions</h3>
            <pre class="language-php"><code>/**
 * File contains the GenderGuess class which can detect genders by names.
 *
 * @author     Bram ten Hove
 * @license    http://opensource.org/licenses/MIT  MIT License
 */

 class GenderGuess {
  /**
   * Function that tries to guess the gender by full name.
   *
   * @param string $fullname
   *   The full name we want to detect the gender of.
   * @param string $ipaddress
   *   Optional IP address we can use for better detection.
   *
   * @return string
   *   Either female, male or unknown.
   */
  public function guessGender($fullname, $ipaddress = null) {
    // Throw new exception if full name is not given or empty.
    if (empty($fullname) && !is_string($fullname)) {
      throw new Exception('No name given.');
    }

    // Get first name from full name.
    try {
      $firstname = $this->getFirstName($fullname);
    } catch (Exception $e) {
      throw new Exception('Invalid first name.');
    }

    // Send the request.
    try {
      $gender = $this->sendRequest($firstname, $ipaddress);

      // Return the gender.
      return $gender;
    } catch (Exception $e) {
      return 'unknown';
    }
  }

  /**
   * Function to get the first name from a full name.
   *
   * @param string $fullname
   *   The full name we have to get the first name from.
   *
   * @return string
   *   The first name.
   */
  public function getFirstName($fullname) {
    // Remove any dots (e.g. J. Doe become J Doe).
    $fullname = str_replace('.', '', $fullname);

    // Explode into first name and the rest.
    $pieces = explode(' ', $fullname);

    // Check if we're dealing with a name we cannot use.
    if (strlen($pieces[0]) < 2) {
      throw new Exception('Invalid first name.');
    }
    else {
      // Return the first name.
      return $pieces[0];
    }
  }

  /**
   * Function that makes a request to the Gender API.
   *
   * @param string $firstname
   *   The first name we will try to detect the gender of.
   * @param string $ipaddress
   *   Optional IP address we can use for better detection.
   *
   * @return string
   *   Either female, male or unknown.
   */
  private function sendRequest($firstname, $ipaddress = null) {
    $request_path = 'https://gender-api.com/get?name=' . urlencode($firstname);

    if (filter_var($ipaddress, FILTER_VALIDATE_IP)) {
      $request_path .= '&ip=' . $ipaddress;
    }

    // Make the API request.
    $ch = curl_init($request_path);
    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "GET");
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

    // The result from Gender API.
    $result = json_decode(curl_exec($ch));

    // Close curl request.
    curl_close($ch);

    // Detect proper result.
    if (!isset($result->errno)) {
      // Return the detected gender.
      return $result->gender;
    }
    else {
      throw new Exception('Error in inquiry result.');
    }
  }
}</code></pre>

            <span class="post-number">#2</span>

            <div class="details">
              <span class="date-time"><time datetime="2014-06-13">Thursday, June 13, 2014</time></span>
            </div>
          </div>
        </div>

        <div class="separator"></div>

        <aside id="sidebar-right" role="complementary">
          <div class="block container">
            <h2 class="block-title">Latest from the lab</h2>
            <p>Search Krumo is a Drupal module that makes live for developers a lot easier. It enables you to search through those vast arrays Drupal manages to create. <a href="/blogs/search-krumo">Read about it in this blog</a></p>
          </div>

          <div class="block container">
            <h2 class="block-title">Who's website is this?</h2>
            <img class="full-width" src="/public/images/me.jpg" />
            <p>My name is Bram ten Hove. I am a passionate webdeveloper that tries to stay curious and learn new things. Drupal, JavaScript, privacy, security, performance.</p>

            <span class="center"><a class="button" href="/contact">Say hello to me</a></span>
          </div>
        </aside>

      </div>

      <div id="footer" role="footer">
        <div class="wrapper">
          <img class="copyright" src="/public/images/assets/copyright.png" />
        </div>
      </div>

    </div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/public/javascripts/vendor/jquery-1.11.1.min.js"><\/script>')</script>
    <script src="/public/javascripts/vendor/prism.js"></script>
    <script src="/public/javascripts/main.js"></script>
  </body>
</html>
